define(["Util","CubicBezier"],function(t,e){function i(e){this.config=t.deepCopy(e,t.deepCopy(n)),this.animateTimer=null,this.pageNum=this.config.pageNum,this.itemWidth=this.config.itemWidth,this.pageWidth=this.config.pageNum*this.config.itemWidth,this.pageTotal=0,this.QueueOpt=[],this.QueueStatus="stop",this.items=null,this.scroll_banner=null,this.scroll_wrap=null,this.prev_button=null,this.next_button=null,this.init()}var s={easeOutBack:function(t,e,i,s,n){return i*((t=t/s-1)*t*(2.35*t+1.35)+1)+e},easeOutCubic:function(t,e,i,s){return i*((t=t/s-1)*t*t+1)+e},linear:function(t,e,i,s){return i*t/s+e}},n={easeFun:"easeOutCubic",pageNum:5,itemWidth:200,bannerID:"buy_now_scroll_banner",wrapID:"buy_now_scroll_banner_wrap",itemClassName:"product",steps:60};return i.prototype.init=function(){var e=this.scroll_banner=t.$$(this.config.bannerID);this.scroll_wrap=t.$$(this.config.wrapID),this.prev_button=t.$("prev",e)[0],this.next_button=t.$("next",e)[0],this.initUI(),this.initEvent()},i.prototype.initUI=function(){var e=Array.prototype.slice.call(t.$(this.config.itemClassName,this.scroll_wrap));if(e.length/this.pageNum>1)for(var i=e.slice(0,this.pageNum),s=e.slice(-this.pageNum),n=0;n<this.pageNum;n++)this.scroll_wrap.appendChild(i[n].cloneNode(!0)),this.scroll_wrap.insertBefore(s[this.pageNum-1-n].cloneNode(!0),this.scroll_wrap.childNodes[0]);this.scroll_wrap.style.left=-this.pageWidth+"px",this.scroll_wrap.style.width=this.pageNum*this.pageWidth+"px",this.pageTotal=e.length/this.pageNum+2,this.prev_button.style.display="none",this.next_button.style.display="none",this.items=t.$(this.config.itemClassName,this.scroll_wrap),this.changeLineStatus("hide")},i.prototype.initEvent=function(){var t=this;this.scroll_banner.onmouseover=function(){t.prev_button.style.display="block",t.next_button.style.display="block"},this.scroll_banner.onmouseout=function(){t.prev_button.style.display="none",t.next_button.style.display="none"},this.prev_button.onclick=function(){t.QueueOpt.push("prev"),t.startQueue()},this.next_button.onclick=function(){t.QueueOpt.push("next"),t.startQueue()}},i.prototype.startQueue=function(){"runing"!=this.QueueStatus&&(this.QueueStatus="runing",this.runQueue())},i.prototype.runQueue=function(){0!=this.QueueOpt.length?"prev"==this.QueueOpt.shift()?this.prev():this.next():this.QueueStatus="stop"},i.prototype.prev=function(){var t=this.scroll_wrap.offsetLeft+this.pageWidth;t==this.pageWidth&&(this.scroll_wrap.style.left=-(this.pageTotal-2)*this.pageWidth+"px",t=-(this.pageTotal-3)*this.pageWidth),this.animate(this.scroll_wrap.offsetLeft,t)},i.prototype.next=function(){var t=this.scroll_wrap.offsetLeft-this.pageWidth;t==-this.pageTotal*this.pageWidth&&(this.scroll_wrap.style.left=-this.pageWidth+"px",t=2*-this.pageWidth),this.animate(this.scroll_wrap.offsetLeft,t)},i.prototype.changeLineStatus=function(e){var i=Math.abs(this.scroll_wrap.offsetLeft)/this.pageWidth*this.pageNum+this.pageNum-1,s=t.$("line",this.items[i])[0];s&&(s.style.display="show"==e?"block":"none")},i.prototype.animate=function(t,e){clearInterval(this.animateTimer);var i=this,n=0,o=this.config.steps;this.changeLineStatus("show"),this.animateTimer=setInterval(function(){var a=s[i.config.easeFun](n,t,e-t,o);i.scroll_wrap.style.left=a+"px",++n>o&&(clearInterval(i.animateTimer),i.changeLineStatus("hide"),i.runQueue())},10)},i.initScrollBaner=function(){new i({easeFun:"linear",steps:40});for(var e=t.$("core_footer_panel"),s=0;s<e.length;s++){e[s].id="scroll_logos_banner"+s;var n=t.$("logos_con",e[s])[0];n.style.position="absolute",n.id="scroll_logos_banner_wrap"+s,new i({easeFun:"easeOutBack",pageNum:24==t.$("logo",n).length?12:6,itemWidth:95,bannerID:"scroll_logos_banner"+s,wrapID:"scroll_logos_banner_wrap"+s,itemClassName:"logo",steps:60})}},i});